package kevin.module.modules.exploit

import kevin.module.ListValue
import kevin.module.Module
import kevin.module.ModuleCategory
import kevin.utils.ChatUtils
import net.minecraft.network.play.client.CPacketPlayer
import net.minecraft.network.play.client.CPacketUseEntity
import java.util.*

class Kick : Module("Kick", "Allows you to kick yourself from a server.", category = ModuleCategory.EXPLOIT) {
    private val modeValue = ListValue("Mode", arrayOf("Quit", "InvalidPacket", "SelfHurt", "IllegalChat", "PacketSpam"), "Quit")

    override fun onEnable() {
        if (mc.isIntegratedServerRunning) {
            ChatUtils.message("§c§lError: §aYou can't enable §c§l'Kick' §ain SinglePlayer.")
            return
        }

        val player = mc.player!!

        when (modeValue.get().toLowerCase()) {
            "quit" -> mc.world!!.sendQuittingDisconnectingPacket()
            "invalidpacket" -> mc.connection!!.sendPacket(CPacketPlayer.Position(Double.NaN, Double.NEGATIVE_INFINITY, Double.POSITIVE_INFINITY, !player.onGround))
            "selfhurt" -> mc.connection!!.sendPacket(CPacketUseEntity(player))
            "illegalchat" -> player.sendChatMessage(Random().nextInt().toString() + "§§§" + Random().nextInt())
            "packetspam" -> {
                repeat(9999) {
                    mc.connection!!.sendPacket(CPacketPlayer.Position(it.toDouble(), it.toDouble(), it.toDouble(),
                        Random().nextBoolean()))
                }
            }
        }
        state = false
    }
}